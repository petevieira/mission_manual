\documentclass[letterpaper, 10 pt]{report}

% For handling graphics
\usepackage{graphicx}
% For multirows in tables
\usepackage{multirow}
% For colors
\usepackage{color}
% For hyperlink
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linktoc=all,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=blue
}
\usepackage[margin=1.0in]{geometry}

% -------------------------------------------------------------------------------------
% TITLE PAGE
% -------------------------------------------------------------------------------------
\begin{document}
\begin{titlepage}
\center
% Headings
\textsc{\LARGE Georgia Institute of Technology}\\[1.5cm]
\textsc{\large Center for Robotics \& Intelligent Machines}\\[0.5cm]
\textsc{\large Humanoid Robotics Lab}\\[0.5cm]
% Title
\rule{\linewidth}{0.5mm}\\[0.4cm]
{\huge \bfseries GT Mission Manual}\\[0.4cm]
\rule{\linewidth}{0.5mm}\\[1.5cm]
% Author
\textsc{\normalsize M.X. Grey}\\
\textsc{\normalsize Eric Huang}\\
\textsc{\normalsize Andrew Price}\\
\textsc{\normalsize Peter Vieira}\\[1.5cm]
% Image
\includegraphics[width=5.0cm]{resources/hubo-titlepage}
% Fill rest of page with whitespace
\vfill
\end{titlepage}

% -------------------------------------------------------------------------------------
% MISSION MANUAL
% -------------------------------------------------------------------------------------

% -------------------------------------------------------------------------------------
% CODE REPOS
%
\section*{Code Repositories}\label{sec:code-repos}
\subsection*{Real-time Code}
Code repositories that run in real-time on the robot.
\begin{itemize}
\item hubo-ach
  \begin{itemize}
	\item \url{https://github.com/hubo/hubo-ach}
	  \begin{itemize}
	    \item Dependencies: \textit{ach, libreadline.}
	  \end{itemize}
  \end{itemize}
\item hubo-motion-rt
	\begin{itemize}
	\item \url{https://github.com/hubo/hubo-motion-rt}
	  \begin{itemize}
	    \item Dependencies: \textit{hubo-ach, RobotKin, urdfdom, eigen3.}
	  \end{itemize}
  \end{itemize}
\item hubomz
  \begin{itemize}
	\item \url{https://github.com/golems/hubomz}
	  \begin{itemize}
	    \item Dependencies: \textit{hubo-ach, hubo-motion-rt, expat, freeglut3.} 
	  \end{itemize}
  \end{itemize}
\end{itemize}
\subsection*{ROS Code}
Code repositories that use ros-groovy.
\begin{itemize}
\item hubo\_init
  \begin{itemize}
	\item \url{https://github.com/hubo/hubo\_init/}
	  \begin{itemize}
	    \item Dependencies: \textit{hubo-ach}
	  \end{itemize}
  \end{itemize}
\item hubo\_walk
  \begin{itemize}
	\item \url{https://github.com/hubo/hubo\_walk}
	  \begin{itemize}
	    \item Dependencies: \textit{hubo-motion-rt, hubomz}
	  \end{itemize}
  \end{itemize}
\item hubo\_urdf
  \begin{itemize}
    \item \url{https://github.com/a-price/hubo\_urdf}
  \end{itemize}
\item rgbd\_graph\_segmentation
  \begin{itemize}
    \item \url{https://github.com/a-price/rgbd\_graph\_segmentation}
  \end{itemize}
\item hubo\_motion\_ros
  \begin{itemize}
	\item \url{https://github.com/a-price/hubo\_motion\_ros}
	  \begin{itemize}
	    \item Dependencies: \textit{hubo\_urdf, rgbd\_graph\_segmentation, ros-groovy-control-msgs}
	  \end{itemize}
  \end{itemize}
\item hubo\_manipulation\_planner
  \begin{itemize}
	\item \url{https://github.com/hubo/hubo\_manipulation\_planner}
	  \begin{itemize}
	    \item Dependencies: \textit{hubo\_urdf, rgbd\_graph\_segmentation, ros-groovy-control-msgs}
	  \end{itemize}
  \end{itemize}
\end{itemize}
\newpage

% -------------------------------------------------------------------------------------
% WALL DRILLING INTRO
%
\section*{Wall Drilling Task}\label{wall-drilling-task}

\subsection*{Procedure}
\begin{enumerate}
\item Identify the drill using robot/human judgement from robot perception feedback.
\item Walk to the drill and pick it up using vision and teleopration from the hubo\_maniupaltion\_planner panel.
\item Identify wall location using human judgement of robot perception.
\item Walk to the wall and face it using the hubo\_walk panel.
\item Begin static balancing using hubo\_walk panel.
\item Use hubo\_manipulation\_planner to identify points on the wall defining polygon to drill out and it's distance away from the wall. Step closer if needed.
\item Send the points in 6-dimensions to the manipulation daemon using the end-effector interpolation mode to drill the object out.
\item Remove drill from wall and place on table or drop.
\end{enumerate}
\begin{figure}[ht]
  \centering
  \includegraphics[width=5.0cm]{resources/wall-drilling}
  \caption{Picture of example target to drill out.}
  \label{fig:Wall-image}
\end{figure}

\newpage

% -------------------------------------------------------------------------------------
% RUBBLE CLEARING INTRO
%
\section*{Rubble Clearing Task}\label{sec:rubble-clearing-task}
\begin{enumerate}
\item Identify the location of the rubble/door using robot/human judgement from robot perception feedback.
\item Walk to the rubble and face it using the hubo\_walk panel.
\item Begin static balancing and squat to height which allows picking up rubble items.
\item Use dual-arm teleoperation to pick up the pieces of rubble and toss them to the side.
\end{enumerate}
\begin{figure}[ht]
  \centering
  \includegraphics[width=5.0cm]{resources/rubble-clearing}
  \caption{Picture of example rubble scene.}
  \label{fig:Rubble-image}
\end{figure}

\newpage

% -------------------------------------------------------------------------------------
% INSTRUCTIONS
%
\section*{Operation Instructions}\label{sec:operating-instructions}
This section details how to operate Hubo from the initialization phase to execution of the tasks. The different phases include \textit{Starting-up Hubo}, \textit{Starting-up Perception}, \textit{Walking}, and \textit{Teleop Manipulation}.
\subsection*{Starting-up Hubo}
This section describes how to start-up Hubo.
\begin{enumerate}
  \item ssh hubo@192.168.0.201
  \item Turn on motor controllers with remote
  \item sudo service hubo-motion start
  \item launch RViz
    \begin{itemize}
    	  \item roscore
    	  \item rosrun rviz rviz
    	  \item Click on the \textit{HuboInitPanel} panel tab.
    \end{itemize}
  \begin{figure}[ht]
    \centering
    \includegraphics[width=15.0cm]{resources/hubo-init.pdf}
    \caption{Picture of hubo\_init panel.}
    \label{fig:hubo-init-image}
  \end{figure}
  \item Ensure "IP Address" is correct.
  \item Click "Connect" to send and receive ach channels between Hubo's computer and the remote computer. If it won't connect see the Troubleshooting section.
  \item Click "Home All" to home all of Hubo's joints, if not on the ground and not homed. If already homed and standing, continue skip to step.
  \item If any active joints do not home, indicated by the color in the \textit{Joint State} section not being gray, click the "Rehome". Button color meanings are
    \begin{itemize}
      \item GRAY: homed
      \item PURPLE: not homed
      \item RED: error
      \item WHITE: inactive
    \end{itemize}
  \item If any joints won't home, you can do one of two options:
    \begin{enumerate}
      \item Run sudo service hubo-motion stop, run sudo servi	ce hubo-motion start, and then start the process over again.
      \item Click the \textit{Reset} radio button and then click the joint(s) that won't home. Then click the \textit{Home} radio button and click the joint(s) that didn't home. Then press the "Rehome" button again.
    \end{enumerate}
  \item Once the joints are all homed, press the "Start Sensors" button to initialize the IMU and Force/Torque sensors.
  \item Click on the \textit{Sensor State} tab and ensure the sensor values are updating and are reasonable. If they aren't, then restart the whole process.
\end{enumerate}

\subsection*{Starting-up Perception}
This section describes how to get the perception pipeline up and running. 

\subsection*{Walking}
This section describes how to make Hubo walk. And assumes the robot is already up and running and standing on the ground on two feet.
  \begin{enumerate}
    \item Click on the \textit{HuboWalkPanel} tab.
    \begin{figure}[ht]
      \centering
      \includegraphics[width=15.0cm]{resources/hubo-walk.pdf}
      \caption{Picture of hubo\_walk panel.}
      \label{fig:hubo-walk-image}
    \end{figure}
    \item Ensure the IP Address is correct.
    \item Click "Connect" to send and receive ach channels between Hubo's computer and the remote computer. If it won't connect see the Troubleshooting section.
    \item Click the \textit{Joystick} radio button if it is not already selected.
    \item Based on vision feedback enter desired walk distance, max number of steps, and turn-in-place angle (for turning in place).
    \item Click the "Go Quad" button to transition into quadruped mode.
    \item Click the walk command desired to get to your desired goal. (Eventually the interface will use a desired location and orientation, and the ZMP walk generator will create a footstep plan to get there.) The \textit{Walk Continuously} checkbox determines whether or not to walk the specified distance or walk until receiving a stop command. The \textit{ZMP State} section at the bottom of the panel display the state of the ZMP walker generator.
    \item Click "Go Biped" to get back up on two feet in order to manipulate objects.
    \item In the \textit{Balance Commands} section of the panel, click "Balance" to go into static balancing mode.
    \item The x-location of the center of mass can be adjusted in the \textit{COM-X Offset (m)} field. Then click the "Balance" button to send the command.
    \item The squat height of the robot can be adjusted by sliding the \textit{Height} slider up and down, which automatically sends the command to the robot.
  \end{enumerate}

\subsection*{Manipulation}
This section describes how to teleoperate Hubo in order to dual-arm manipulate objects in the environment.
\begin{enumerate}
  \item ssh to the hubo-vision PC
    \begin{itemize}
      \item ssh hubo-vision
    \end{itemize}
  \item Export the ROS\_MASTER to use your local PC's ROS\_MASTER
    \begin{itemize}
      \item export ROS\_MASTER\_URI=http://YOUR\_LOCAL\_MACHINE
    \end{itemize}
  \item Start the camera node
    \begin{itemize}
      \item roslaunch openni\_launch openni.launch
    \end{itemize}
  \item Start the manipulation planner
    \begin{itemize} 
      \item roslaunch\ hubo\_manipulation\_planner manipulation\_pipeline.launch
    \end{itemize}
  \item To view the camera image
    \begin{itemize}
      \item roslaunch hubo\_motion\_ros hubo\_manipulation.launch
    \end{itemize}
  \item To visualize Hubo's joint states
    \begin{itemize}
      \item roslaunch hubo\_motion\_ros hubo\_state.launch
    \end{itemize}
    \begin{figure}[ht]
    \centering
    \includegraphics[width=10.0cm]{resources/pickup-drill-rviz}
    \caption{Picture of hubo\_init panel.}
    \label{fig:pickup-drill-rviz-image}
    \end{figure}
\end{enumerate}


% -------------------------------------------------------------------------------------
% TROUBLESHOOTING
%

\newpage 
\section*{Troubleshooting}\label{sec:troubleshooting}
\begin{table}[h]
  \centering
  \caption{Troubleshooting Table}
  \begin{tabular}{|p{4.5cm}|p{4.5cm}|p{4.5cm}|} \hline
    \multicolumn{1}{|c|}{Symptom} & \multicolumn{1}{|c|}{Causes} &       \multicolumn{1}{|c|}{Solution} \\ \hline
    Can't ssh to Hubo's PC & Not on correct network. \newline Hubo's PC is stuck in the Grub menu & Connect to the correct network. \newline Connect a monitor and keyboard to Hubo's PC and debug, or just a keyboard and press enter. \\
    \hline
    Can't connect to the robot in RViz panel & Not on the correct network. \newline The daemons are not running on Hubo & Connect to the correct network. \newline Ensure daemons are running by typing \textit{ps aux $|$ grep daemon} or restarting Hubo and running \textit{sudo service hubo-motion start}. \\
    \hline
     &  &  \\
    \hline
  \end{tabular} \label{tbl:troubleshooting}
\end{table}


% -------------------------------------------------------------------------------------
% REFERENCES
% -------------------------------------------------------------------------------------
%\bibliography{}

% -------------------------------------------------------------------------------------
% END DOCUMENT
% -------------------------------------------------------------------------------------
\end{document}
